// schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id           String    @id @default(cuid())
  email        String    @unique
  password     String
  name         String?
  bots         Bot[]
  payments     Payment[]
  plan         Plan      @default(FREE)
  requestsLeft Int       @default(100)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

// === BOT MODEL UPDATE ===
model Bot {
  id        String   @id @default(cuid())
  name      String
  owner     User     @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId   String
  apiKey    ApiKey?
  createdAt DateTime @default(now())

  
  status         BotStatus @default(ACTIVE)
  totalQueries   Int       @default(0)
  lastActivityAt DateTime?
  primaryColor   String?   @default("#007bff")
  headerText     String?   @default("Chat with AI")
  initialMessage String?   @default("Hi! How can I help you today?")
  trainedSources String[]
}


enum BotStatus {
  ACTIVE
  INACTIVE
  TRAINING
}

model ApiKey {
  id        String   @id @default(cuid())
  key       String   @unique
  bot       Bot      @relation(fields: [botId], references: [id], onDelete: Cascade)
  botId     String   @unique
  createdAt DateTime @default(now())
}

model Payment {
  id         String   @id @default(cuid())
  razorpayId String   @unique
  amount     Int
  status     String
  user       User     @relation(fields: [userId], references: [id])
  userId     String
  createdAt  DateTime @default(now())
}

enum Plan {
  FREE
  PRO
}